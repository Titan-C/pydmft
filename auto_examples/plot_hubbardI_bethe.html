<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hubbard I solver Bethe lattice &#8212; Learn DMFT 0.5.0-git documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hubbard III approximation" href="plot_hubbardIII.html" />
    <link rel="prev" title="Bethe lattice semi-elliptical DOS" href="plot_bethe.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_hubbardIII.html" title="Hubbard III approximation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_bethe.html" title="Bethe lattice semi-elliptical DOS"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">DMFT examples</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hubbard-i-solver-bethe-lattice">
<span id="sphx-glr-auto-examples-plot-hubbardi-bethe-py"></span><h1>Hubbard I solver Bethe lattice<a class="headerlink" href="#hubbard-i-solver-bethe-lattice" title="Permalink to this headline">¶</a></h1>
<p>Atomic limit expression of the self-energy
is described by</p>
<div class="math">
<p><img src="../_images/math/bce0629f06ae7c652d53a8a80e739067bbb9cec2.png" alt="\Sigma(\omega) =\frac{U n}{2} + \frac{ \frac{U^{2} n}{2} \left( 1 - \frac{n}{2}\right)}{\omega + \mu  - U \left(1 - \frac{n}{2}\right)}"/></p>
</div><p>This approximation is most accurate in the limit of strong coupling,
as there the atomic case is closer. Nevertheless it is possible to see
the formation of the Hubbard Bands and the redistribution of spectral
weight.</p>
<img alt="../_images/sphx_glr_plot_hubbardI_bethe_001.png" class="align-center" src="../_images/sphx_glr_plot_hubbardI_bethe_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">n_new</span> <span class="mf">1.97901484639</span>
<span class="n">n_new</span> <span class="mf">1.67550206029</span>
<span class="n">n_new</span> <span class="mf">1.78121999181</span>
<span class="n">n_new</span> <span class="mf">1.74447416817</span>
<span class="n">n_new</span> <span class="mf">1.75728528387</span>
<span class="n">n_new</span> <span class="mf">1.75279719806</span>
<span class="n">n_new</span> <span class="mf">1.75437710222</span>
<span class="n">n_new</span> <span class="mf">1.75382113619</span>
<span class="n">n_new</span> <span class="mf">1.75401684774</span>
<span class="n">n_new</span> <span class="mf">1.75394795984</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Created Mon Sep 28 15:25:30 2015</span>
<span class="c1"># Author: Óscar Nájera</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapz</span>
<span class="kn">import</span> <span class="nn">dmft.common</span> <span class="kn">as</span> <span class="nn">gf</span>


<span class="k">def</span> <span class="nf">hubbard_aprox</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">dmu</span><span class="p">,</span> <span class="n">omega</span><span class="p">):</span>

    <span class="n">mu</span> <span class="o">=</span> <span class="n">U</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">dmu</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mf">1.</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">U</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> \
            <span class="n">U</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">omega</span> <span class="o">+</span> <span class="mf">0.05j</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">U</span><span class="p">)</span>
        <span class="n">gloc</span> <span class="o">=</span> <a href="../gen_modules/dmft.common.html#dmft.common.semi_circle_hiltrans" title="View documentation for dmft.common.semi_circle_hiltrans"><span class="n">gf</span><span class="o">.</span><span class="n">semi_circle_hiltrans</span></a><span class="p">(</span><span class="n">omega</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="n">dos</span> <span class="o">=</span> <span class="o">-</span><span class="n">gloc</span><span class="o">.</span><span class="n">imag</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">trapz</span><span class="p">(</span><span class="n">dos</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">omega</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;n_new&#39;</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="View documentation for matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="o">-</span><span class="n">gloc</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>

<span class="n">omega</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">hubbard_aprox</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">2.051</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.show" title="View documentation for matplotlib.pyplot.show"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.065 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_hubbardI_bethe.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_hubbardI_bethe.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_hubbardI_bethe.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_hubbardI_bethe.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_bethe.html"
                        title="previous chapter">Bethe lattice semi-elliptical DOS</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_hubbardIII.html"
                        title="next chapter">Hubbard III approximation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/auto_examples/plot_hubbardI_bethe.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_hubbardIII.html" title="Hubbard III approximation"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_bethe.html" title="Bethe lattice semi-elliptical DOS"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >DMFT examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Óscar Nájera.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>