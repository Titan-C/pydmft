<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Compare the spectra and Fermi Liquid Parametrization &#8212; Learn DMFT 0.5.0-git documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="compare-the-spectra-and-fermi-liquid-parametrization">
<span id="sphx-glr-dimer-lattice-nature-dimer-plot-spectra-uc2-compare-py"></span><h1>Compare the spectra and Fermi Liquid Parametrization<a class="headerlink" href="#compare-the-spectra-and-fermi-liquid-parametrization" title="Permalink to this headline">¶</a></h1>
<p>Using a calculation in Matsubara frequencies then estimating the Fermi
Liquid behavior on those frequencies calculate the low energy
theory. Then continuate by Padé. Also continuate Sigma by Padé and do
the parametrization. Finally do everything on Real frequency IPT.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Author: Óscar Nájera</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.interpolate.splrep.html#scipy.interpolate.splrep" title="View documentation for scipy.interpolate.splrep"><span class="n">splrep</span></a><span class="p">,</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.interpolate.splev.html#scipy.interpolate.splev" title="View documentation for scipy.interpolate.splev"><span class="n">splev</span></a>

<span class="kn">import</span> <span class="nn">dmft.common</span> <span class="kn">as</span> <span class="nn">gf</span>
<span class="kn">from</span> <span class="nn">dmft</span> <span class="kn">import</span> <span class="n">ipt_imag</span>
<span class="kn">from</span> <span class="nn">dmft</span> <span class="kn">import</span> <span class="n">ipt_real</span>
<span class="kn">import</span> <span class="nn">dmft.dimer</span> <span class="kn">as</span> <span class="nn">dimer</span>


<span class="k">def</span> <span class="nf">zero_f_meas_mat</span><span class="p">(</span><span class="n">siw_d</span><span class="p">,</span> <span class="n">siw_o</span><span class="p">):</span>
    <span class="n">sd_zew</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.polyfit.html#numpy.polyfit" title="View documentation for numpy.polyfit"><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">siw_d</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">so_zew</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.polyfit.html#numpy.polyfit" title="View documentation for numpy.polyfit"><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">siw_o</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">zet</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sd_zew</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">zet</span><span class="p">,</span> <span class="n">so_zew</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sd_zew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">low_en_qp</span><span class="p">(</span><span class="n">ss</span><span class="p">):</span>
    <span class="n">glp</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mf">0.</span><span class="p">])</span>
    <span class="n">sigtck</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.interpolate.splrep.html#scipy.interpolate.splrep" title="View documentation for scipy.interpolate.splrep"><span class="n">splrep</span></a><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sig_0</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.interpolate.splev.html#scipy.interpolate.splev" title="View documentation for scipy.interpolate.splev"><span class="n">splev</span></a><span class="p">(</span><span class="n">glp</span><span class="p">,</span> <span class="n">sigtck</span><span class="p">,</span> <span class="n">der</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dw_sig0</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.interpolate.splev.html#scipy.interpolate.splev" title="View documentation for scipy.interpolate.splev"><span class="n">splev</span></a><span class="p">(</span><span class="n">glp</span><span class="p">,</span> <span class="n">sigtck</span><span class="p">,</span> <span class="n">der</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">quas_z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">dw_sig0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">quas_z</span><span class="p">,</span> <span class="n">sig_0</span><span class="p">,</span> <span class="n">dw_sig0</span>


<span class="k">def</span> <span class="nf">plot_spectral</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ylim</span><span class="p">,</span> <span class="n">low_en</span><span class="p">):</span>
    <span class="n">quas_z</span><span class="p">,</span> <span class="n">sig_0</span><span class="p">,</span> <span class="n">dw_sig0</span> <span class="o">=</span> <span class="n">low_en</span>
    <span class="n">tpp</span> <span class="o">=</span> <span class="p">(</span><span class="n">tp</span> <span class="o">+</span> <span class="n">sig_0</span><span class="p">)</span> <span class="o">*</span> <span class="n">quas_z</span>
    <span class="n">gss</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.semi_circle_hiltrans" title="View documentation for dmft.common.semi_circle_hiltrans"><span class="n">gf</span><span class="o">.</span><span class="n">semi_circle_hiltrans</span></a><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mf">1e-8j</span> <span class="o">-</span> <span class="n">tp</span> <span class="o">-</span> <span class="n">ss</span><span class="p">)</span>
    <span class="n">llg</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.semi_circle_hiltrans" title="View documentation for dmft.common.semi_circle_hiltrans"><span class="n">gf</span><span class="o">.</span><span class="n">semi_circle_hiltrans</span></a><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mf">1e-8j</span> <span class="o">-</span> <span class="n">tpp</span><span class="p">,</span> <span class="n">quas_z</span><span class="p">)</span> <span class="o">*</span> <span class="n">quas_z</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="n">gss</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;C1-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="o">-</span><span class="n">llg</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;C3--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">&#39;$\beta={}$; $U={}$; $t_\perp={}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">BETA</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$Z={:.3}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">quas_z</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
               <span class="sa">r</span><span class="s1">&#39;$\tilde{{t}}_\perp={:.3f}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tpp</span><span class="p">),</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Re e$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\Im m$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sig_0</span> <span class="o">+</span> <span class="n">dw_sig0</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">ylim</span><span class="p">)</span>


<span class="n">w</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">)</span>
<span class="n">dw</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">BETA</span> <span class="o">=</span> <span class="mf">756.</span>

<span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.tau_wn_setup" title="View documentation for dmft.common.tau_wn_setup"><span class="n">gf</span><span class="o">.</span><span class="n">tau_wn_setup</span></a><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">BETA</span><span class="o">=</span><span class="n">BETA</span><span class="p">,</span> <span class="n">N_MATSUBARA</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">12</span><span class="p">))</span>
<span class="n">nfp</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.fermi_dist" title="View documentation for dmft.common.fermi_dist"><span class="n">gf</span><span class="o">.</span><span class="n">fermi_dist</span></a><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">BETA</span><span class="p">)</span>

<span class="n">U</span><span class="p">,</span> <span class="n">tp</span> <span class="o">=</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">0.3</span>

<span class="c1"># Matsubara</span>
<span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span> <span class="o">=</span> <a href="../../gen_modules/dmft.dimer.html#dmft.dimer.gf_met" title="View documentation for dmft.dimer.gf_met"><span class="n">dimer</span><span class="o">.</span><span class="n">gf_met</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../gen_modules/dmft.dimer.html#dmft.dimer.ipt_dmft_loop" title="View documentation for dmft.dimer.ipt_dmft_loop"><span class="n">dimer</span><span class="o">.</span><span class="n">ipt_dmft_loop</span></a><span class="p">(</span>
    <span class="n">BETA</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">)</span>
<span class="n">g0iw_d</span><span class="p">,</span> <span class="n">g0iw_o</span> <span class="o">=</span> <a href="../../gen_modules/dmft.dimer.html#dmft.dimer.self_consistency" title="View documentation for dmft.dimer.self_consistency"><span class="n">dimer</span><span class="o">.</span><span class="n">self_consistency</span></a><span class="p">(</span>
    <span class="mi">1j</span> <span class="o">*</span> <span class="n">w_n</span><span class="p">,</span> <span class="mi">1j</span> <span class="o">*</span> <span class="n">giw_d</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">giw_o</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">siw_d</span><span class="p">,</span> <span class="n">siw_o</span> <span class="o">=</span> <a href="../../gen_modules/dmft.ipt_imag.html#dmft.ipt_imag.dimer_sigma" title="View documentation for dmft.ipt_imag.dimer_sigma"><span class="n">ipt_imag</span><span class="o">.</span><span class="n">dimer_sigma</span></a><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">g0iw_d</span><span class="p">,</span> <span class="n">g0iw_o</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span><span class="p">)</span>

<span class="c1"># Continuate sigma with Padé</span>
<span class="n">w_set</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">761</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
<span class="n">ss</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../../gen_modules/dmft.dimer.html#dmft.dimer.pade_diag" title="View documentation for dmft.dimer.pade_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">pade_diag</span></a><span class="p">(</span><span class="mi">1j</span> <span class="o">*</span> <span class="n">siw_d</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">siw_o</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">w_n</span><span class="p">,</span> <span class="n">w_set</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mf">0.0005j</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="low-energy-in-sigma-matsubara">
<h2>Low Energy in Sigma matsubara<a class="headerlink" href="#low-energy-in-sigma-matsubara" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_spectral</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">zero_f_meas_mat</span><span class="p">(</span><span class="n">siw_d</span><span class="p">,</span> <span class="n">siw_o</span><span class="p">))</span>
<span class="c1"># ax[1].set_title(&#39;Low Energy Matsubara sigma + Padé Sigma for plot&#39;)</span>
<span class="c1"># fig.savefig(&#39;IPT_comp_mat_lowe.pdf&#39;)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_spectra_Uc2_compare_001.png" class="align-center" src="../../_images/sphx_glr_plot_spectra_Uc2_compare_001.png" />
</div>
<div class="section" id="low-energy-in-continuated-sigma">
<h2>Low Energy in continuated sigma<a class="headerlink" href="#low-energy-in-continuated-sigma" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_spectral</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">low_en_qp</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span>
<span class="c1"># ax[1].set_title(&#39;Low Energy Padé Sigma&#39;)</span>
<span class="c1"># fig.savefig(&#39;IPT_comp_pade_lowe.pdf&#39;)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_spectra_Uc2_compare_002.png" class="align-center" src="../../_images/sphx_glr_plot_spectra_Uc2_compare_002.png" />
</div>
<div class="section" id="all-in-real-frequencies">
<h2>All in real frequencies<a class="headerlink" href="#all-in-real-frequencies" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">gss</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.semi_circle_hiltrans" title="View documentation for dmft.common.semi_circle_hiltrans"><span class="n">gf</span><span class="o">.</span><span class="n">semi_circle_hiltrans</span></a><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mf">5e-3j</span><span class="p">)</span>
<span class="n">gsa</span> <span class="o">=</span> <a href="../../gen_modules/dmft.common.html#dmft.common.semi_circle_hiltrans" title="View documentation for dmft.common.semi_circle_hiltrans"><span class="n">gf</span><span class="o">.</span><span class="n">semi_circle_hiltrans</span></a><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mf">5e-3j</span><span class="p">)</span>
<span class="p">(</span><span class="n">gss</span><span class="p">,</span> <span class="n">gsa</span><span class="p">),</span> <span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">sa</span><span class="p">)</span> <span class="o">=</span> <a href="../../gen_modules/dmft.ipt_real.html#dmft.ipt_real.dimer_dmft" title="View documentation for dmft.ipt_real.dimer_dmft"><span class="n">ipt_real</span><span class="o">.</span><span class="n">dimer_dmft</span></a><span class="p">(</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">nfp</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">dw</span><span class="p">,</span> <span class="n">gss</span><span class="p">,</span> <span class="n">gsa</span><span class="p">,</span> <span class="n">conv</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_spectral</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">ss</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">low_en_qp</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span>
<span class="c1"># ax[1].set_title(&#39;All Real frequency IPT&#39;)</span>
<span class="c1"># fig.savefig(&#39;IPT_comp_real_lowe.pdf&#39;)</span>
<span class="c1"># plt.close(&#39;all&#39;)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_spectra_Uc2_compare_003.png" class="align-center" src="../../_images/sphx_glr_plot_spectra_Uc2_compare_003.png" />
<p><strong>Total running time of the script:</strong> ( 0 minutes  1.764 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_spectra_Uc2_compare.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_spectra_Uc2_compare.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_spectra_Uc2_compare.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_spectra_Uc2_compare.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Compare the spectra and Fermi Liquid Parametrization</a><ul>
<li><a class="reference internal" href="#low-energy-in-sigma-matsubara">Low Energy in Sigma matsubara</a></li>
<li><a class="reference internal" href="#low-energy-in-continuated-sigma">Low Energy in continuated sigma</a></li>
<li><a class="reference internal" href="#all-in-real-frequencies">All in real frequencies</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dimer_lattice/nature_dimer/plot_spectra_Uc2_compare.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Óscar Nájera.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>