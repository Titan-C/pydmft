<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Isolated molecule spectral function in symmetric basis &#8212; Learn DMFT 0.5.0-git documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="isolated-molecule-spectral-function-in-symmetric-basis">
<span id="sphx-glr-dimer-lattice-plot-molecule-bonding-py"></span><h1>Isolated molecule spectral function in symmetric basis<a class="headerlink" href="#isolated-molecule-spectral-function-in-symmetric-basis" title="Permalink to this headline">¶</a></h1>
<p>For the case of contact interaction in the di-atomic molecule case
spectral function are evaluated by means of the Lehmann representation</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># author: Óscar Nájera</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="kn">as</span> <span class="nn">LA</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">dmft.plot</span> <span class="kn">import</span> <span class="n">plot_band_dispersion</span>
<span class="kn">import</span> <span class="nn">dmft.dimer</span> <span class="kn">as</span> <span class="nn">dimer</span>
<span class="kn">import</span> <span class="nn">slaveparticles.quantum.operators</span> <span class="kn">as</span> <span class="nn">op</span>

<span class="kn">from</span> <span class="nn">pyutils.latex_print</span> <span class="kn">import</span> <span class="n">ket</span>
</pre></div>
</div>
<div class="highlight-pytb"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/home/oscar/dev/sphinx-gallery/sphinx_gallery/gen_rst.py&quot;</span>, line <span class="m">453</span>, in <span class="n">execute_code_block</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">code_block</span><span class="p">,</span> <span class="n">example_globals</span><span class="p">)</span>
  File <span class="nb">&quot;&lt;string&gt;&quot;</span>, line <span class="m">12</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">ModuleNotFoundError</span>: <span class="n">No module named &#39;pyutils&#39;</span>
</pre></div>
</div>
<div class="section" id="the-dimer-alone">
<h2>The Dimer alone<a class="headerlink" href="#the-dimer-alone" title="Permalink to this headline">¶</a></h2>
<p>The ground state for half filling is defined at superposition of S=0
states containing the double occupation of each site plus the
individually occupied sites. This allows for the super-exchange
process and makes it the ground state. The first exited state is
formed by the triplet states S=1 where sites are singly occupied</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_eigen_spectra</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>
    <span class="n">h_at</span><span class="p">,</span> <span class="n">oper</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.hamiltonian_diag" title="View documentation for dmft.dimer.hamiltonian_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">hamiltonian_diag</span></a><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">eig_e</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">eig_e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigvalsh.html#scipy.linalg.eigvalsh" title="View documentation for scipy.linalg.eigvalsh"><span class="n">LA</span><span class="o">.</span><span class="n">eigvalsh</span></a><span class="p">(</span><span class="n">h_at</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">todense</span><span class="p">()))</span>
    <span class="n">eig_e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigvalsh.html#scipy.linalg.eigvalsh" title="View documentation for scipy.linalg.eigvalsh"><span class="n">LA</span><span class="o">.</span><span class="n">eigvalsh</span></a><span class="p">(</span><span class="n">h_at</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">todense</span><span class="p">()))</span>
    <span class="n">eig_e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigvalsh.html#scipy.linalg.eigvalsh" title="View documentation for scipy.linalg.eigvalsh"><span class="n">LA</span><span class="o">.</span><span class="n">eigvalsh</span></a><span class="p">(</span><span class="n">h_at</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">todense</span><span class="p">()))</span>

    <a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title" title="View documentation for matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Many particle Energy Spectra U={} $t_\perp={}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">))</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="View documentation for matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.concatenate.html#numpy.concatenate" title="View documentation for numpy.concatenate"><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span></a><span class="p">(</span><span class="n">eig_e</span><span class="p">),</span> <span class="s2">&quot;o-&quot;</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel" title="View documentation for matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel" title="View documentation for matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s1">&#39;Eigenstate by N particle block&#39;</span><span class="p">)</span>

    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.axvline" title="View documentation for matplotlib.pyplot.axvline"><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span></a><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>
    <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.axvline" title="View documentation for matplotlib.pyplot.axvline"><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span></a><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">9.5</span><span class="p">)</span>
<span class="n">plot_eigen_spectra</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>From the next Spectral functions we see that exitations go from
ground state to the bonding anti-bonding bands. If the ground-state
is close to the triplet state or reachable by thermal exitation, it
is also possible to see the exitation from the triplet state to the
bonding anti-bonding bands.</p>
<p>The main role in the spetra is played by the local interaction,
which is allowed to grow sufficiently. It split the largely the
exitation spectra, the inner hopping parameter plays little role,
only to lift the ground state degeneracy by super-exchange.</p>
</div>
<div class="section" id="diagonal-basis">
<h2>Diagonal basis<a class="headerlink" href="#diagonal-basis" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_A_ev_utp</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">urange</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">tprange</span><span class="p">):</span>
    <span class="n">w</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1j</span> <span class="o">*</span> <span class="mf">1e-2</span>
    <span class="n">Aw</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">u_int</span><span class="p">,</span> <span class="n">tp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">urange</span><span class="p">,</span> <span class="n">tprange</span><span class="p">):</span>
        <span class="n">h_at</span><span class="p">,</span> <span class="n">oper</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.hamiltonian_diag" title="View documentation for dmft.dimer.hamiltonian_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">hamiltonian_diag</span></a><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
        <span class="n">eig_e</span><span class="p">,</span> <span class="n">eig_v</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">(</span><span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
        <span class="n">gf</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">gf_lehmann</span><span class="p">(</span><span class="n">eig_e</span><span class="p">,</span> <span class="n">eig_v</span><span class="p">,</span> <span class="n">oper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">aw</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">imag</span> <span class="o">/</span> <span class="n">gf</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">Aw</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aw</span><span class="p">)</span>
    <span class="k">return</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">Aw</span><span class="p">)</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mf">100.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">plot_A_ev_utp</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">w</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="n">plot_band_dispersion</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Molecule exitation spectral function, $\beta={}$, $t_\perp+U=1$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
    <span class="n">beta</span><span class="p">),</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">))</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel" title="View documentation for matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$U+A(\omega)$&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlim" title="View documentation for matplotlib.pyplot.xlim"><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel" title="View documentation for matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$U$&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel" title="View documentation for matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylim" title="View documentation for matplotlib.pyplot.ylim"><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="weights-of-spectra">
<h2>weights of spectra<a class="headerlink" href="#weights-of-spectra" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">exitation_ration</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">tp</span><span class="p">):</span>

    <span class="n">h_h2</span><span class="p">,</span> <span class="n">oper</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.hamiltonian_diag" title="View documentation for dmft.dimer.hamiltonian_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">hamiltonian_diag</span></a><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">eig_vecs</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigh.html#scipy.linalg.eigh" title="View documentation for scipy.linalg.eigh"><span class="n">LA</span><span class="o">.</span><span class="n">eigh</span></a><span class="p">(</span><span class="n">h_h2</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>

    <span class="n">basis_create</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.dot.html#numpy.dot" title="View documentation for numpy.dot"><span class="n">np</span><span class="o">.</span><span class="n">dot</span></a><span class="p">(</span><span class="n">eig_vecs</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">oper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">eig_vecs</span><span class="p">))</span>
    <span class="n">tmat</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.square.html#numpy.square" title="View documentation for numpy.square"><span class="n">np</span><span class="o">.</span><span class="n">square</span></a><span class="p">(</span><span class="n">basis_create</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tmat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">tmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="n">tpr</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">ur</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">tpx</span><span class="p">,</span> <span class="n">uy</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="View documentation for numpy.meshgrid"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><span class="n">tpr</span><span class="p">,</span> <span class="n">ur</span><span class="p">)</span>
<span class="n">ex_rat</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([[</span><span class="n">exitation_ration</span><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="n">tp</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">tpr</span><span class="p">]</span> <span class="k">for</span> <span class="n">u_int</span> <span class="ow">in</span> <span class="n">ur</span><span class="p">])</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.pcolormesh" title="View documentation for matplotlib.pyplot.pcolormesh"><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span></a><span class="p">(</span><span class="n">tpx</span><span class="p">,</span> <span class="n">uy</span><span class="p">,</span> <span class="n">ex_rat</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;inferno&#39;</span><span class="p">))</span>
<a href="http://matplotlib.org/api/colorbar_api.html#matplotlib.colorbar" title="View documentation for matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.xlabel" title="View documentation for matplotlib.pyplot.xlabel"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t_\perp$&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.ylabel" title="View documentation for matplotlib.pyplot.ylabel"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$U$&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title" title="View documentation for matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Intensity ratio of peaks in the bonding basis&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="probability-of-each-state">
<h2>Probability of each state<a class="headerlink" href="#probability-of-each-state" title="Permalink to this headline">¶</a></h2>
<p>In the next section I study the distribution of states in the
molecule. How they relate to the shape of the Hamiltonian and the
density matrix.</p>
<p>First I start in the low temperature regime where the ground state
dominates the behavior of the system. Taking <img class="math" src="../_images/math/80baca5055c136e1e68e5fce7395eee4eee581e5.png" alt="\beta=200"/> and
<img class="math" src="../_images/math/274410cc040000549237e6ba03be6b3705634331.png" alt="U=2.15,t_\perp=0.3"/> the Hamiltonian of the system and the
density matrix look as follow.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">basis_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;AS\uparrow&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;S\uparrow&#39;</span><span class="p">,</span> <span class="s1">&#39;AS\downarrow&#39;</span><span class="p">,</span>  <span class="s1">&#39;S\downarrow&#39;</span><span class="p">]</span>
<span class="n">ind</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
<span class="n">chartlab</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="n">ket</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">basis_names</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">h_at</span><span class="p">,</span> <span class="n">oper</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.hamiltonian_diag" title="View documentation for dmft.dimer.hamiltonian_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">hamiltonian_diag</span></a><span class="p">(</span><span class="mf">2.15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ev</span><span class="p">,</span> <span class="n">evec</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigh.html#scipy.linalg.eigh" title="View documentation for scipy.linalg.eigh"><span class="n">LA</span><span class="o">.</span><span class="n">eigh</span></a><span class="p">(</span><span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="n">Z</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.sum.html#numpy.sum" title="View documentation for numpy.sum"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.exp.html#numpy.exp" title="View documentation for numpy.exp"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="n">wh_at</span> <span class="o">=</span> <span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.eye.html#numpy.eye" title="View documentation for numpy.eye"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow" title="View documentation for matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/colorbar_api.html#matplotlib.colorbar" title="View documentation for matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.yticks" title="View documentation for matplotlib.pyplot.yticks"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">chartlab</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title" title="View documentation for matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Hamiltonian&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/tight_layout_api.html#matplotlib.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>

<span class="n">rho</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.expm.html#scipy.linalg.expm" title="View documentation for scipy.linalg.expm"><span class="n">LA</span><span class="o">.</span><span class="n">expm</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">wh_at</span><span class="p">)</span> <span class="o">/</span> <span class="n">Z</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow" title="View documentation for matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.yticks" title="View documentation for matplotlib.pyplot.yticks"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">chartlab</span><span class="p">)</span>
<a href="http://matplotlib.org/api/colorbar_api.html#matplotlib.colorbar" title="View documentation for matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title" title="View documentation for matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Density matrix&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/tight_layout_api.html#matplotlib.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="the-weight-of-each-state">
<h3>The weight of each state<a class="headerlink" href="#the-weight-of-each-state" title="Permalink to this headline">¶</a></h3>
<p>The diagonal elements of the density matrix give the weight of each
state the next plot signal in blue the weight of the basis states in
the recognizable quantum numbers and the green curve is the density
matrix in the diagonal basis where one can follow by decreasing
weight each state.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="View documentation for matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.diag.html#numpy.diag" title="View documentation for numpy.diag"><span class="n">np</span><span class="o">.</span><span class="n">diag</span></a><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.yticks" title="View documentation for matplotlib.pyplot.yticks"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">chartlab</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">diagbas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;{:+.2}{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">ke</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">evec</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">chartlab</span><span class="p">)</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="n">ax2</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.twinx" title="View documentation for matplotlib.pyplot.twinx"><span class="n">plt</span><span class="o">.</span><span class="n">twinx</span></a><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.exp.html#numpy.exp" title="View documentation for numpy.exp"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="n">Z</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s1">&#39;sg-&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">diagbas</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/tight_layout_api.html#matplotlib.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
<p>The weight of each state at B=5</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">h_at</span><span class="p">,</span> <span class="n">oper</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.hamiltonian_diag" title="View documentation for dmft.dimer.hamiltonian_diag"><span class="n">dimer</span><span class="o">.</span><span class="n">hamiltonian_diag</span></a><span class="p">(</span><span class="mf">2.15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ev</span><span class="p">,</span> <span class="n">evec</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.eigh.html#scipy.linalg.eigh" title="View documentation for scipy.linalg.eigh"><span class="n">LA</span><span class="o">.</span><span class="n">eigh</span></a><span class="p">(</span><span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
<span class="n">Z</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.sum.html#numpy.sum" title="View documentation for numpy.sum"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.exp.html#numpy.exp" title="View documentation for numpy.exp"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="n">wh_at</span> <span class="o">=</span> <span class="n">h_at</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.eye.html#numpy.eye" title="View documentation for numpy.eye"><span class="n">np</span><span class="o">.</span><span class="n">eye</span></a><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="n">rho</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.linalg.expm.html#scipy.linalg.expm" title="View documentation for scipy.linalg.expm"><span class="n">LA</span><span class="o">.</span><span class="n">expm</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">wh_at</span><span class="p">)</span> <span class="o">/</span> <span class="n">Z</span>
<a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow" title="View documentation for matplotlib.pyplot.imshow"><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span></a><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.yticks" title="View documentation for matplotlib.pyplot.yticks"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">chartlab</span><span class="p">)</span>
<a href="http://matplotlib.org/api/colorbar_api.html#matplotlib.colorbar" title="View documentation for matplotlib.pyplot.colorbar"><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.title" title="View documentation for matplotlib.pyplot.title"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s1">&#39;Density matrix&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/tight_layout_api.html#matplotlib.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>The weight of each state<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The diagonal elements of the density matrix give the weight of each
state the next plot signal in blue the weight of the basis states in
the recognizable quantum numbers and the green curve is the density
matrix in the diagonal basis where one can follow by decreasing
weight each state.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><a href="http://matplotlib.org/api/figure_api.html#matplotlib.figure" title="View documentation for matplotlib.pyplot.figure"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.plot" title="View documentation for matplotlib.pyplot.plot"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.diag.html#numpy.diag" title="View documentation for numpy.diag"><span class="n">np</span><span class="o">.</span><span class="n">diag</span></a><span class="p">(</span><span class="n">rho</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.yticks" title="View documentation for matplotlib.pyplot.yticks"><span class="n">plt</span><span class="o">.</span><span class="n">yticks</span></a><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="n">chartlab</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">diagbas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s2">&quot;{:+.2}{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">w</span><span class="p">,</span> <span class="n">ke</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">evec</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">chartlab</span><span class="p">)</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span>
<span class="n">ax2</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.twinx" title="View documentation for matplotlib.pyplot.twinx"><span class="n">plt</span><span class="o">.</span><span class="n">twinx</span></a><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.exp.html#numpy.exp" title="View documentation for numpy.exp"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">ev</span> <span class="o">-</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">/</span> <span class="n">Z</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="s1">&#39;sg-&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">diagbas</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<a href="http://matplotlib.org/api/tight_layout_api.html#matplotlib.tight_layout" title="View documentation for matplotlib.pyplot.tight_layout"><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span></a><span class="p">()</span>
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_molecule_bonding.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_molecule_bonding.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_molecule_bonding.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_molecule_bonding.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Isolated molecule spectral function in symmetric basis</a><ul>
<li><a class="reference internal" href="#the-dimer-alone">The Dimer alone</a></li>
<li><a class="reference internal" href="#diagonal-basis">Diagonal basis</a></li>
<li><a class="reference internal" href="#weights-of-spectra">weights of spectra</a></li>
<li><a class="reference internal" href="#probability-of-each-state">Probability of each state</a><ul>
<li><a class="reference internal" href="#the-weight-of-each-state">The weight of each state</a></li>
<li><a class="reference internal" href="#id1">The weight of each state</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dimer_lattice/plot_molecule_bonding.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Óscar Nájera.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>