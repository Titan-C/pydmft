<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Scattering rates change in Temperature &#8212; Learn DMFT 0.5.0-git documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.5.0-git',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Phase diagrams" href="plot_phases.html" />
    <link rel="prev" title="INSULATOR" href="plot_ipt_insulator.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_phases.html" title="Phase diagrams"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_ipt_insulator.html" title="INSULATOR"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">The Dimer Hubbard Model</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="scattering-rates-change-in-temperature">
<span id="sphx-glr-dimer-lattice-plot-scattering-py"></span><h1>Scattering rates change in Temperature<a class="headerlink" href="#scattering-rates-change-in-temperature" title="Permalink to this headline">¶</a></h1>
<p>Explore the low energy expansion of the Matsubara self-energy. The
zero frequency value being the scattering rate.
Figure is discussed in reference <a class="reference internal" href="#najera2017" id="id1">[Najera2017]</a></p>
<table class="docutils citation" frame="void" id="najera2017" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Najera2017]</a></td><td>O. Nájera, Civelli, M., V. Dobrosavljevic, &amp; Rozenberg,
M. J. (2017). Resolving the VO_2 controversy: Mott mechanism dominates
the insulator-to-metal transition. Physical Review B, 95(3),
035113. <a class="reference external" href="http://dx.doi.org/10.1103/physrevb.95.035113">http://dx.doi.org/10.1103/physrevb.95.035113</a></td></tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Created Mon Mar  7 01:14:02 2016</span>
<span class="c1"># Author: Óscar Nájera</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">print_function</span>

<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">log</span><span class="p">,</span> <span class="n">ceil</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">dmft.dimer</span> <span class="kn">as</span> <span class="nn">dimer</span>
<span class="kn">import</span> <span class="nn">dmft.common</span> <span class="kn">as</span> <span class="nn">gf</span>
<span class="kn">import</span> <span class="nn">dmft.ipt_imag</span> <span class="kn">as</span> <span class="nn">ipt</span>


<span class="k">def</span> <span class="nf">loop_beta</span><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">betarange</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="s1">&#39;ins&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solves IPT dimer and return Im Sigma_AA, Re Simga_AB</span>

<span class="sd">    returns list len(betarange) x 2 Sigma arrays &quot;&quot;&quot;</span>

    <span class="n">sigma_iw</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betarange</span><span class="p">:</span>
        <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span> <span class="o">=</span> <a href="../gen_modules/dmft.common.html#dmft.common.tau_wn_setup" title="View documentation for dmft.common.tau_wn_setup"><span class="n">gf</span><span class="o">.</span><span class="n">tau_wn_setup</span></a><span class="p">(</span>
            <span class="nb">dict</span><span class="p">(</span><span class="n">BETA</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">N_MATSUBARA</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">ceil</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">256</span><span class="p">)))</span>
        <span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.gf_met" title="View documentation for dmft.dimer.gf_met"><span class="n">dimer</span><span class="o">.</span><span class="n">gf_met</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="o">==</span> <span class="s1">&#39;ins&#39;</span><span class="p">:</span>
            <span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1j</span> <span class="o">*</span> <span class="n">w_n</span> <span class="o">-</span> <span class="mi">4j</span> <span class="o">/</span> <span class="n">w_n</span><span class="p">),</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.zeros_like.html#numpy.zeros_like" title="View documentation for numpy.zeros_like"><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0j</span>

        <span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span><span class="p">,</span> <span class="n">loops</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.ipt_dmft_loop" title="View documentation for dmft.dimer.ipt_dmft_loop"><span class="n">dimer</span><span class="o">.</span><span class="n">ipt_dmft_loop</span></a><span class="p">(</span>
            <span class="n">beta</span><span class="p">,</span> <span class="n">u_int</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">giw_d</span><span class="p">,</span> <span class="n">giw_o</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
        <span class="n">iterations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loops</span><span class="p">)</span>
        <span class="n">g0iw_d</span><span class="p">,</span> <span class="n">g0iw_o</span> <span class="o">=</span> <a href="../gen_modules/dmft.dimer.html#dmft.dimer.self_consistency" title="View documentation for dmft.dimer.self_consistency"><span class="n">dimer</span><span class="o">.</span><span class="n">self_consistency</span></a><span class="p">(</span>
            <span class="mi">1j</span> <span class="o">*</span> <span class="n">w_n</span><span class="p">,</span> <span class="mi">1j</span> <span class="o">*</span> <span class="n">giw_d</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">giw_o</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="n">siw_d</span><span class="p">,</span> <span class="n">siw_o</span> <span class="o">=</span> <a href="../gen_modules/dmft.ipt_imag.html#dmft.ipt_imag.dimer_sigma" title="View documentation for dmft.ipt_imag.dimer_sigma"><span class="n">ipt</span><span class="o">.</span><span class="n">dimer_sigma</span></a><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">g0iw_d</span><span class="p">,</span> <span class="n">g0iw_o</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span><span class="p">)</span>
        <span class="n">sigma_iw</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">siw_d</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">siw_o</span><span class="o">.</span><span class="n">real</span><span class="p">))</span>

    <span class="k">print</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">iterations</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">sigma_iw</span>
</pre></div>
</div>
<p>Calculate the dimer solution for Metals up to Uc2 in the in the given
temperature range. Include the behavior of 2 insulators inside the
coexistence region.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">500.</span><span class="p">,</span> <span class="o">.</span><span class="mo">05</span><span class="p">,</span> <span class="o">.</span><span class="mo">001</span><span class="p">)</span>
<span class="n">BETARANGE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">temp</span>

<span class="n">U_intm</span> <span class="o">=</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.linspace.html#numpy.linspace" title="View documentation for numpy.linspace"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">sigmasM_U</span> <span class="o">=</span> <span class="p">[</span><span class="n">loop_beta</span><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="s1">&#39;met&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">u_int</span> <span class="ow">in</span> <span class="n">U_intm</span><span class="p">]</span>

<span class="n">U_inti</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
<span class="n">sigmasI_U</span> <span class="o">=</span> <span class="p">[</span><span class="n">loop_beta</span><span class="p">(</span><span class="n">u_int</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="s1">&#39;ins&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">u_int</span> <span class="ow">in</span> <span class="n">U_inti</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">487</span> <span class="mi">327</span> <span class="mi">245</span> <span class="mi">198</span> <span class="mi">162</span> <span class="mi">142</span> <span class="mi">126</span> <span class="mi">111</span> <span class="mi">100</span>  <span class="mi">90</span>  <span class="mi">85</span>  <span class="mi">75</span>  <span class="mi">70</span>  <span class="mi">65</span>  <span class="mi">64</span>  <span class="mi">59</span>  <span class="mi">59</span>  <span class="mi">54</span>
  <span class="mi">49</span>  <span class="mi">49</span>  <span class="mi">49</span>  <span class="mi">44</span>  <span class="mi">44</span>  <span class="mi">44</span>  <span class="mi">39</span>  <span class="mi">39</span>  <span class="mi">38</span>  <span class="mi">34</span>  <span class="mi">34</span>  <span class="mi">34</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">29</span>  <span class="mi">29</span>  <span class="mi">29</span>  <span class="mi">28</span>
  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span><span class="p">]</span>
<span class="p">[</span><span class="mi">481</span> <span class="mi">322</span> <span class="mi">239</span> <span class="mi">193</span> <span class="mi">162</span> <span class="mi">136</span> <span class="mi">121</span> <span class="mi">106</span> <span class="mi">100</span>  <span class="mi">90</span>  <span class="mi">80</span>  <span class="mi">75</span>  <span class="mi">70</span>  <span class="mi">64</span>  <span class="mi">64</span>  <span class="mi">59</span>  <span class="mi">54</span>  <span class="mi">54</span>
  <span class="mi">49</span>  <span class="mi">49</span>  <span class="mi">44</span>  <span class="mi">44</span>  <span class="mi">44</span>  <span class="mi">39</span>  <span class="mi">39</span>  <span class="mi">39</span>  <span class="mi">38</span>  <span class="mi">34</span>  <span class="mi">34</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">29</span>  <span class="mi">29</span>  <span class="mi">28</span>  <span class="mi">28</span>
  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span><span class="p">]</span>
<span class="p">[</span><span class="mi">464</span> <span class="mi">310</span> <span class="mi">233</span> <span class="mi">187</span> <span class="mi">156</span> <span class="mi">131</span> <span class="mi">115</span> <span class="mi">105</span>  <span class="mi">95</span>  <span class="mi">85</span>  <span class="mi">79</span>  <span class="mi">74</span>  <span class="mi">69</span>  <span class="mi">64</span>  <span class="mi">59</span>  <span class="mi">54</span>  <span class="mi">54</span>  <span class="mi">49</span>
  <span class="mi">49</span>  <span class="mi">44</span>  <span class="mi">44</span>  <span class="mi">43</span>  <span class="mi">39</span>  <span class="mi">39</span>  <span class="mi">38</span>  <span class="mi">34</span>  <span class="mi">34</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">29</span>  <span class="mi">29</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>
  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">19</span>  <span class="mi">19</span><span class="p">]</span>
<span class="p">[</span><span class="mi">435</span> <span class="mi">287</span> <span class="mi">216</span> <span class="mi">175</span> <span class="mi">145</span> <span class="mi">125</span> <span class="mi">109</span>  <span class="mi">99</span>  <span class="mi">89</span>  <span class="mi">79</span>  <span class="mi">74</span>  <span class="mi">69</span>  <span class="mi">64</span>  <span class="mi">59</span>  <span class="mi">54</span>  <span class="mi">49</span>  <span class="mi">48</span>  <span class="mi">44</span>
  <span class="mi">43</span>  <span class="mi">43</span>  <span class="mi">38</span>  <span class="mi">38</span>  <span class="mi">38</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">29</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">23</span>
  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span><span class="p">]</span>
<span class="p">[</span><span class="mi">405</span> <span class="mi">269</span> <span class="mi">199</span> <span class="mi">158</span> <span class="mi">133</span> <span class="mi">113</span>  <span class="mi">98</span>  <span class="mi">88</span>  <span class="mi">78</span>  <span class="mi">73</span>  <span class="mi">68</span>  <span class="mi">63</span>  <span class="mi">58</span>  <span class="mi">53</span>  <span class="mi">48</span>  <span class="mi">48</span>  <span class="mi">43</span>  <span class="mi">43</span>
  <span class="mi">38</span>  <span class="mi">38</span>  <span class="mi">38</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">32</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>
  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span><span class="p">]</span>
<span class="p">[</span><span class="mi">364</span> <span class="mi">245</span> <span class="mi">180</span> <span class="mi">146</span> <span class="mi">121</span> <span class="mi">101</span>  <span class="mi">87</span>  <span class="mi">77</span>  <span class="mi">72</span>  <span class="mi">62</span>  <span class="mi">57</span>  <span class="mi">52</span>  <span class="mi">52</span>  <span class="mi">47</span>  <span class="mi">42</span>  <span class="mi">42</span>  <span class="mi">37</span>  <span class="mi">37</span>
  <span class="mi">33</span>  <span class="mi">33</span>  <span class="mi">32</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>
  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span><span class="p">]</span>
<span class="p">[</span><span class="mi">331</span> <span class="mi">219</span> <span class="mi">162</span> <span class="mi">128</span> <span class="mi">104</span>  <span class="mi">89</span>  <span class="mi">79</span>  <span class="mi">70</span>  <span class="mi">60</span>  <span class="mi">56</span>  <span class="mi">51</span>  <span class="mi">46</span>  <span class="mi">42</span>  <span class="mi">41</span>  <span class="mi">37</span>  <span class="mi">36</span>  <span class="mi">32</span>  <span class="mi">32</span>
  <span class="mi">31</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">14</span>
  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">10</span>  <span class="mi">10</span><span class="p">]</span>
<span class="p">[</span><span class="mi">296</span> <span class="mi">193</span> <span class="mi">142</span> <span class="mi">110</span>  <span class="mi">91</span>  <span class="mi">77</span>  <span class="mi">68</span>  <span class="mi">58</span>  <span class="mi">54</span>  <span class="mi">49</span>  <span class="mi">45</span>  <span class="mi">40</span>  <span class="mi">36</span>  <span class="mi">35</span>  <span class="mi">31</span>  <span class="mi">31</span>  <span class="mi">27</span>  <span class="mi">26</span>
  <span class="mi">26</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>
  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">11</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>   <span class="mi">9</span><span class="p">]</span>
<span class="p">[</span><span class="mi">265</span> <span class="mi">171</span> <span class="mi">127</span>  <span class="mi">96</span>  <span class="mi">82</span>  <span class="mi">69</span>  <span class="mi">60</span>  <span class="mi">51</span>  <span class="mi">47</span>  <span class="mi">42</span>  <span class="mi">38</span>  <span class="mi">34</span>  <span class="mi">30</span>  <span class="mi">29</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">21</span>
  <span class="mi">21</span>  <span class="mi">21</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">11</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>
   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span><span class="p">]</span>
<span class="p">[</span><span class="mi">236</span> <span class="mi">148</span> <span class="mi">110</span>  <span class="mi">85</span>  <span class="mi">69</span>  <span class="mi">57</span>  <span class="mi">48</span>  <span class="mi">44</span>  <span class="mi">40</span>  <span class="mi">36</span>  <span class="mi">32</span>  <span class="mi">28</span>  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">20</span>  <span class="mi">20</span>  <span class="mi">17</span>
  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">10</span>  <span class="mi">10</span>   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span>
  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span><span class="p">]</span>
<span class="p">[</span><span class="mi">205</span> <span class="mi">128</span>  <span class="mi">94</span>  <span class="mi">71</span>  <span class="mi">56</span>  <span class="mi">48</span>  <span class="mi">40</span>  <span class="mi">36</span>  <span class="mi">30</span>  <span class="mi">26</span>  <span class="mi">25</span>  <span class="mi">22</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">12</span>
  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">11</span>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">11</span>  <span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">18</span>
  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">20</span>  <span class="mi">20</span>  <span class="mi">20</span>  <span class="mi">20</span>  <span class="mi">20</span>  <span class="mi">20</span><span class="p">]</span>
<span class="p">[</span><span class="mi">175</span> <span class="mi">107</span>  <span class="mi">73</span>  <span class="mi">56</span>  <span class="mi">46</span>  <span class="mi">36</span>  <span class="mi">30</span>  <span class="mi">26</span>  <span class="mi">23</span>  <span class="mi">20</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">12</span>
  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">23</span>  <span class="mi">24</span>  <span class="mi">25</span>  <span class="mi">25</span>
  <span class="mi">26</span>  <span class="mi">26</span>  <span class="mi">26</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">27</span>  <span class="mi">26</span>  <span class="mi">26</span><span class="p">]</span>
<span class="p">[</span><span class="mi">138</span>  <span class="mi">80</span>  <span class="mi">54</span>  <span class="mi">42</span>  <span class="mi">33</span>  <span class="mi">27</span>  <span class="mi">22</span>  <span class="mi">19</span>  <span class="mi">16</span>  <span class="mi">14</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">16</span>
  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">24</span>  <span class="mi">26</span>  <span class="mi">29</span>  <span class="mi">31</span>  <span class="mi">33</span>  <span class="mi">35</span>  <span class="mi">37</span>  <span class="mi">39</span>  <span class="mi">41</span>  <span class="mi">42</span>  <span class="mi">43</span>  <span class="mi">43</span>  <span class="mi">44</span>  <span class="mi">44</span>
  <span class="mi">43</span>  <span class="mi">43</span>  <span class="mi">42</span>  <span class="mi">41</span>  <span class="mi">40</span>  <span class="mi">39</span>  <span class="mi">38</span>  <span class="mi">37</span>  <span class="mi">36</span>  <span class="mi">35</span>  <span class="mi">34</span>  <span class="mi">33</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span>  <span class="mi">9</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">18</span> <span class="mi">47</span> <span class="mi">28</span>
 <span class="mi">23</span> <span class="mi">21</span> <span class="mi">16</span> <span class="mi">15</span> <span class="mi">15</span> <span class="mi">18</span> <span class="mi">16</span> <span class="mi">15</span> <span class="mi">18</span> <span class="mi">12</span> <span class="mi">20</span> <span class="mi">20</span> <span class="mi">19</span> <span class="mi">18</span> <span class="mi">21</span> <span class="mi">20</span> <span class="mi">21</span> <span class="mi">21</span> <span class="mi">21</span> <span class="mi">21</span> <span class="mi">17</span> <span class="mi">17</span> <span class="mi">21</span><span class="p">]</span>
<span class="p">[</span> <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>  <span class="mi">7</span>
  <span class="mi">7</span>  <span class="mi">8</span>  <span class="mi">8</span>  <span class="mi">8</span>  <span class="mi">8</span>  <span class="mi">9</span>  <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">14</span> <span class="mi">17</span> <span class="mi">27</span> <span class="mi">55</span> <span class="mi">39</span> <span class="mi">32</span> <span class="mi">29</span> <span class="mi">27</span> <span class="mi">25</span> <span class="mi">23</span> <span class="mi">22</span> <span class="mi">21</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<p>Plot the zero frequency extrapolation of the self-energy. Top panel
shows for all metals how upon cooling they become more coherent.
Interestingly enough is the insulators is red showning even higher
coherence(lower value of the scattering rate) than the metal. This is
how the dimer Mott insulator fundamentally differs from the Single Site
DMFT Mott insulator. When performing a correct analytical continuation
of the Self-energy on the insulator it becomes evident that it is gaped
at zero frequency.</p>
<p>The lower panel shows the effective hybridization of the dimers. It is
barely changed in the metal but is strongly boosted in the insulator.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_zero_w</span><span class="p">(</span><span class="n">function_array</span><span class="p">,</span> <span class="n">iter_range</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">betarange</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot the zero frequency extrapolation of a function</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    function_array: real ndarray</span>
<span class="sd">      contains the function (G, Sigma) to linearly fit over 2 first frequencies</span>
<span class="sd">    iter_range: list floats</span>
<span class="sd">      values of changing variable U or tp</span>
<span class="sd">    berarange: real ndarray 1D, values of beta</span>
<span class="sd">    entry: 0, 1 corresponds to diagonal or off-diagonal entry of function</span>
<span class="sd">    label_head: string for label</span>
<span class="sd">    ax, dx: matplotlib axis to plot in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sig_11_0</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rtp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iter_range</span><span class="p">):</span>
        <span class="n">sig_11_0</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="n">rtp</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beta</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">betarange</span><span class="p">)):</span>
            <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span> <span class="o">=</span> <a href="../gen_modules/dmft.common.html#dmft.common.tau_wn_setup" title="View documentation for dmft.common.tau_wn_setup"><span class="n">gf</span><span class="o">.</span><span class="n">tau_wn_setup</span></a><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">BETA</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">N_MATSUBARA</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">sig_11_0</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.polyfit.html#numpy.polyfit" title="View documentation for numpy.polyfit"><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span>
                <span class="n">w_n</span><span class="p">,</span> <span class="n">function_array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">rtp</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.polyfit.html#numpy.polyfit" title="View documentation for numpy.polyfit"><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span><span class="n">w_n</span><span class="p">,</span> <span class="n">function_array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="o">-</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">sig_11_0</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="n">tp</span> <span class="o">+</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">rtp</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$-\Im m \Sigma_{11}(w=0)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$t_\perp + \Re e\Sigma_{12}(w=0)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">temp</span><span class="p">)])</span>

    <span class="k">return</span> <a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">sig_11_0</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">si</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sig_11_0i</span> <span class="o">=</span> <span class="n">plot_zero_w</span><span class="p">(</span><span class="n">sigmasI_U</span><span class="p">,</span> <span class="n">U_inti</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<span class="c1"># fig, si = plt.subplots(2, 1, sharex=True)</span>
<span class="n">sig_11_0m</span> <span class="o">=</span> <span class="n">plot_zero_w</span><span class="p">(</span><span class="n">sigmasM_U</span><span class="p">,</span> <span class="n">U_intm</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">65</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">25</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">U_intm</span><span class="p">,</span> <span class="o">-</span><span class="n">sig_11_0m</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">7</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.arange.html#numpy.arange" title="View documentation for numpy.arange"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_scattering_001.png" class="align-center" src="../_images/sphx_glr_plot_scattering_001.png" />
<p>Plot the derivative at zero frequency of the self-energy</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_der_zero_w</span><span class="p">(</span><span class="n">function_array</span><span class="p">,</span> <span class="n">iter_range</span><span class="p">,</span> <span class="n">betarange</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">label_head</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">dx</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot the zero frequency extrapolation of a function</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    function_array: real ndarray</span>
<span class="sd">      contains the function (G, Sigma) to linearly fit over 2 first frequencies</span>
<span class="sd">    iter_range: list floats</span>
<span class="sd">      values of changing variable U or tp</span>
<span class="sd">    berarange: real ndarray 1D, values of beta</span>
<span class="sd">    entry: 0, 1 corresponds to diagonal or off-diagonal entry of function</span>
<span class="sd">    label_head: string for label</span>
<span class="sd">    ax, dx: matplotlib axis to plot in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iter_range</span><span class="p">):</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beta</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">betarange</span><span class="p">)):</span>
            <span class="n">tau</span><span class="p">,</span> <span class="n">w_n</span> <span class="o">=</span> <a href="../gen_modules/dmft.common.html#dmft.common.tau_wn_setup" title="View documentation for dmft.common.tau_wn_setup"><span class="n">gf</span><span class="o">.</span><span class="n">tau_wn_setup</span></a><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">BETA</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">N_MATSUBARA</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
            <span class="n">dat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.polyfit.html#numpy.polyfit" title="View documentation for numpy.polyfit"><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span>
                <span class="n">w_n</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">function_array</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">entry</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="o">-</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
                <span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label_head</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
        <span class="n">dx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="o">-</span><a href="http://docs.scipy.org/doc/numpy-1.9.1/reference/generated/numpy.array.html#numpy.array" title="View documentation for numpy.array"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
                <span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">label_head</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>


<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasI_U</span><span class="p">,</span> <span class="n">U_inti</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;INS U=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasM_U</span><span class="p">,</span> <span class="n">U_intm</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;MET U=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasI_U</span><span class="p">,</span> <span class="n">U_inti</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;INS U=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasM_U</span><span class="p">,</span> <span class="n">U_intm</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MET U=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>

<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im \Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im d\Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re \Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re d\Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mo">06</span><span class="p">])</span>

<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_scattering_002.png" class="align-center" src="../_images/sphx_glr_plot_scattering_002.png" />
<p>Changing tp in the METAL dome for metal and insulator Fix U</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">tp_r</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="n">sigmasM_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">loop_beta</span><span class="p">(</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">tp_r</span><span class="p">]</span>
<span class="n">sigmasI_tp</span> <span class="o">=</span> <span class="p">[</span><span class="n">loop_beta</span><span class="p">(</span><span class="mf">2.7</span><span class="p">,</span> <span class="n">tp</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">tp</span> <span class="ow">in</span> <span class="n">tp_r</span><span class="p">]</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasI_tp</span><span class="p">,</span> <span class="n">tp_r</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;INS tp=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasM_tp</span><span class="p">,</span> <span class="n">tp_r</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;MET tp=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasI_tp</span><span class="p">,</span> <span class="n">tp_r</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;INS tp=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_der_zero_w</span><span class="p">(</span><span class="n">sigmasM_tp</span><span class="p">,</span> <span class="n">tp_r</span><span class="p">,</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MET tp=&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im \Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im d\Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">si</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re \Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re d\Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mo">06</span><span class="p">])</span>

<span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_scattering_003.png" class="align-center" src="../_images/sphx_glr_plot_scattering_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">129</span>  <span class="mi">82</span>  <span class="mi">64</span>  <span class="mi">46</span>  <span class="mi">40</span>  <span class="mi">34</span>  <span class="mi">29</span>  <span class="mi">28</span>  <span class="mi">23</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">15</span>
  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>
  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span><span class="p">]</span>
<span class="p">[</span><span class="mi">183</span> <span class="mi">110</span>  <span class="mi">79</span>  <span class="mi">58</span>  <span class="mi">47</span>  <span class="mi">40</span>  <span class="mi">33</span>  <span class="mi">27</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">20</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">11</span>
  <span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">23</span>
  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span><span class="p">]</span>
<span class="p">[</span><span class="mi">157</span>  <span class="mi">96</span>  <span class="mi">64</span>  <span class="mi">47</span>  <span class="mi">38</span>  <span class="mi">30</span>  <span class="mi">24</span>  <span class="mi">20</span>  <span class="mi">17</span>  <span class="mi">14</span>  <span class="mi">12</span>  <span class="mi">10</span>   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>
  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">13</span>  <span class="mi">16</span>  <span class="mi">19</span>  <span class="mi">22</span>  <span class="mi">25</span>  <span class="mi">27</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">26</span>  <span class="mi">25</span>  <span class="mi">23</span>  <span class="mi">21</span>
  <span class="mi">20</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">12</span><span class="p">]</span>
<span class="p">[</span><span class="mi">129</span>  <span class="mi">82</span>  <span class="mi">64</span>  <span class="mi">46</span>  <span class="mi">40</span>  <span class="mi">34</span>  <span class="mi">29</span>  <span class="mi">28</span>  <span class="mi">23</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">15</span>
  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>
  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span>  <span class="mi">16</span><span class="p">]</span>
<span class="p">[</span><span class="mi">183</span> <span class="mi">110</span>  <span class="mi">79</span>  <span class="mi">58</span>  <span class="mi">47</span>  <span class="mi">40</span>  <span class="mi">33</span>  <span class="mi">27</span>  <span class="mi">24</span>  <span class="mi">23</span>  <span class="mi">20</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">11</span>
  <span class="mi">11</span>  <span class="mi">12</span>  <span class="mi">12</span>  <span class="mi">13</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">15</span>  <span class="mi">16</span>  <span class="mi">17</span>  <span class="mi">18</span>  <span class="mi">19</span>  <span class="mi">19</span>  <span class="mi">20</span>  <span class="mi">21</span>  <span class="mi">22</span>  <span class="mi">22</span>  <span class="mi">23</span>  <span class="mi">23</span>
  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">24</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span>  <span class="mi">25</span><span class="p">]</span>
<span class="p">[</span><span class="mi">157</span>  <span class="mi">96</span>  <span class="mi">64</span>  <span class="mi">47</span>  <span class="mi">38</span>  <span class="mi">30</span>  <span class="mi">24</span>  <span class="mi">20</span>  <span class="mi">17</span>  <span class="mi">14</span>  <span class="mi">12</span>  <span class="mi">10</span>   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>
  <span class="mi">10</span>  <span class="mi">10</span>  <span class="mi">10</span>   <span class="mi">9</span>   <span class="mi">9</span>   <span class="mi">9</span>  <span class="mi">13</span>  <span class="mi">16</span>  <span class="mi">19</span>  <span class="mi">22</span>  <span class="mi">25</span>  <span class="mi">27</span>  <span class="mi">28</span>  <span class="mi">28</span>  <span class="mi">26</span>  <span class="mi">25</span>  <span class="mi">23</span>  <span class="mi">21</span>
  <span class="mi">20</span>  <span class="mi">19</span>  <span class="mi">18</span>  <span class="mi">17</span>  <span class="mi">16</span>  <span class="mi">15</span>  <span class="mi">15</span>  <span class="mi">14</span>  <span class="mi">14</span>  <span class="mi">13</span>  <span class="mi">12</span>  <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
<p>Fine graphics</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">([</span><span class="n">sigmasI_U</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">],</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;INS&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">([</span><span class="n">sigmasM_U</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">],</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;MET&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">si</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Im m\Sigma_{Aa}$ cut and slope tp=0.3, U=3&#39;</span><span class="p">)</span>
<span class="n">si</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im \Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Im d\Sigma_{AA}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mo">06</span><span class="p">])</span>
<span class="n">si</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">=</span> <a href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.subplots" title="View documentation for matplotlib.pyplot.subplots"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">([</span><span class="n">sigmasI_U</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">],</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;INS&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">plot_der_zero_w</span><span class="p">([</span><span class="n">sigmasM_U</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">],</span> <span class="n">BETARANGE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;MET&#39;</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
<span class="n">si</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Re e\Sigma_{AB}$ cut and slope tp=0.3, U=3&#39;</span><span class="p">)</span>
<span class="n">si</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re e \Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;-$\Re e d\Sigma_{AB}(w=0)$&#39;</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">.</span><span class="mo">06</span><span class="p">])</span>

<span class="n">si</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="n">ds</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$T/D$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_scattering_004.png"><img alt="../_images/sphx_glr_plot_scattering_004.png" src="../_images/sphx_glr_plot_scattering_004.png" style="width: 300.79999999999995px; height: 225.6px;" /></a>
</li>
<li><a class="first reference internal image-reference" href="../_images/sphx_glr_plot_scattering_005.png"><img alt="../_images/sphx_glr_plot_scattering_005.png" src="../_images/sphx_glr_plot_scattering_005.png" style="width: 300.79999999999995px; height: 225.6px;" /></a>
</li>
</ul>
<p><strong>Total running time of the script:</strong> ( 1 minutes  30.980 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_scattering.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_scattering.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../_downloads/plot_scattering.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_scattering.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_ipt_insulator.html"
                        title="previous chapter">INSULATOR</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_phases.html"
                        title="next chapter">Phase diagrams</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/dimer_lattice/plot_scattering.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="plot_phases.html" title="Phase diagrams"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_ipt_insulator.html" title="INSULATOR"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Learn DMFT 0.5.0-git documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >The Dimer Hubbard Model</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2017, Óscar Nájera.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>